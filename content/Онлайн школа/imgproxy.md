---
date: 2024-10-02
tags:
  - Онлайн-школа
---
Модуль предназначен для проксирования и размытия изображений.

## ImgproxyController

Для доступа к контроллеру необходим действительный JWT токен. В случае, если токен недействителен или отсутствует, запрос будет отклонен, а клиент получит ошибку `401 Unauthorized`.

### Endpoints

Контроллер предоставляет следующий эндпоинт:

| Метод | URL         | Описание                                                                        |
| ----- | ----------- | ------------------------------------------------------------------------------- |
| GET   | `imgproxy/` | [[#Проксирование и размытие изображения\|Проксирование и размытие изображения]] |

### Проксирование и размытие изображения

`GET imgproxy/`

*Входные данные:*

- Проверка наличия прав суперадминистратора при помощи гарда SuperAdminRoleGuard. При отсутствии соответствующей роли, запрос будет отклонен с ошибкой 403 Forbidden.
- Query параметр:

| Параметр | Тип данных | Валидация    | Описание        |
| -------- | ---------- | ------------ | --------------- |
| url      | string     | Обязательный | URL изображения |

*Функционал:*

Для указанного изображения, генерируется новый URL размытого изображения, в котором содержится значение размытия (по умолчанию 25), а также создается HMAC-подпись. Для полученного URL сохраняется `contentType` и данные изображения в бинарном виде.

*Выходные данные:* Status: `200 OK`

Возвращает заголовок типа содержимого ответа `contentType` и файл изображения в бинарном виде.